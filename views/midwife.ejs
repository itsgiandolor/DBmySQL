<!DOCTYPE html>
<html lang="en">
  <%- include("./partials/head.ejs") %>
  <head>
    <link rel="stylesheet" href="/css/styles.css" />
  </head>
<body>
  <%- include("./partials/nav.ejs") %>

  <div class="blogsContent">
    <h1><%= title %></h1>

    <!-- Search Bar (optional) -->
    <!--
    <form action="/midwife/search" method="GET" class="search-form">
      <input type="text" name="query" placeholder="Search midwife..." class="search-input">
      <button type="submit" class="search-button">Search</button>
    </form>
    -->

    <!-- Summary -->
    <div class="summary">
      <h3>Total Midwives: <%= midwife.length %></h3>
    </div>

    <!-- Table -->
    <table class="patients-table">
      <thead>
        <tr>
          <th>Last Name</th>
          <th>First & Middle Name</th>
          <th>Contact No</th>
          <th>Availability</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% midwife.forEach(midwife => { %>
          <tr class="clickable-row" data-id="<%= midwife.id %>">
            <td><%= midwife.last_name %></td>
            <td><%= midwife.first_name %> <%= midwife.middle_name %></td>
            <td><%= midwife.contact_no %></td>
            <td><%= midwife.availability || 'Unknown' %></td>
            <td>
              <a class="edit" href="/midwife/edit/<%= midwife.id %>" onclick="event.stopPropagation()">Edit</a>
              <a class="delete" href="/midwife/delete/<%= midwife.id %>" onclick="event.stopPropagation()">Delete</a>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>

    <% if (totalPages && totalPages > 1) { %>
      <div class="pagination">
        <% for (let i = 1; i <= totalPages; i++) { %>
          <a href="?page=<%= i %>" class="page-link"><%= i %></a>
        <% } %>
      </div>
    <% } %>
  </div>

  <%- include("./partials/footer.ejs") %>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const rows = document.querySelectorAll('.clickable-row');
      rows.forEach(row => {
        row.addEventListener('click', () => {
          const id = row.getAttribute('data-id');
          window.location.href = `/midwife/${id}`;
        });
      });
    });
  </script>

</body>
</html>
